# フロントエンドデザイン

## 1. プロジェクト概要と開発のゴール

- **プロジェクト名:** SyncFam - 家族向けハブアプリ
- **対象機能:**
  - タスクの一覧表示、作成、編集、削除、完了/未完了切り替え
  - 家族メンバー管理
  - カレンダー表示
  - 献立管理
  - お出かけスポット管理
- **開発ゴール:**
  - 共働き家庭の日常的なタスク管理を効率化する
  - 家族のスケジュール・献立・情報を一元管理できるハブとなるアプリを提供する
  - MVP として早期に利用可能な状態を目指し、ユーザーからのフィードバックを迅速に得る
  - **開発方針:** スピード優先、作り込みすぎない、手戻り防止、ステップバイステップでの進行

## 2. ターゲットユーザー

- 共働き家族（特にテクノロジーに親しみのある世帯）
- 子育て中の家族
- PC およびスマートフォンでの利用を想定（初期は PC 向け、段階的にレスポンシブ対応予定）

## 3. 技術スタック

- **UI ライブラリ:** React (v18)
- **TypeScript:** 型安全なコード開発のため
- **状態管理:** Redux Toolkit
- **UI コンポーネントライブラリ:** MUI (Material-UI) v5
- **ルーティング:** React Router v6
- **API クライアント:** axios + カスタムフック
- **フォーム管理:** React Hook Form + Zod
- **CSS:** Tailwind CSS（MUI との併用）
- **ビルドツール:** Vite

## 4. 技術選定と設計方針

### 4.1. API クライアント

- **選定:** axios + カスタムフック
- **選定理由:**
  - axios: 広く使われており、ドキュメントが充実。インターセプターなどの機能が豊富
  - カスタムフック: Redux の Thunk よりも柔軟で、コンポーネントで直接使いやすい
- **基本的な使い方/設定方針:**
  - `src/api/client.ts` でベースとなるクライアントを設定
  - 認証トークンの自動付与や、リフレッシュトークンの処理などをインターセプターで実装
  - 各機能（タスク、家族など）ごとに API フックを作成（`src/api/hooks/useTaskApi.ts` など）

### 4.2. ルーティング

- **選定ライブラリ:** React Router Dom v6
- **選定理由:**
  - React アプリの事実上の標準ライブラリ
  - v6 では宣言的なルーティングがより簡潔になり、ネストされたルートの扱いも改善
- **MVP における基本的なルーティング構成案:**
  - `/login` - ログイン画面
  - `/register` - ユーザー登録
  - `/dashboard` - メインダッシュボード
  - `/tasks` - タスク管理画面
  - `/calendar` - カレンダー画面
  - `/menu` - 献立管理画面
  - `/places` - お出かけスポット管理画面
  - `/settings` - アプリ設定画面
  - `/family` - 家族設定画面

### 4.3. フォーム管理

- **選定ライブラリ:** React Hook Form + Zod
- **選定理由:**
  - React Hook Form: パフォーマンスが高く、不要な再レンダリングを抑制
  - Zod: TypeScript との相性が良く、スキーマからの型推論が強力
  - MUI との連携が容易
- **Zod スキーマとの連携方法:**
  - バックエンドの OpenAPI スキーマから自動生成、または手動で作成したスキーマを使用
  - `@hookform/resolvers/zod` を使って Zod スキーマを React Hook Form のバリデーションとして利用
  - フォームの型安全性を確保

### 4.4. ディレクトリ構成

- **推奨ディレクトリ構成:**

```
frontend/
├── public/            # 静的ファイル
├── src/
│   ├── api/           # API関連
│   │   ├── client.ts  # Axiosベースクライアント
│   │   └── hooks/     # APIカスタムフック
│   ├── app/           # アプリケーション設定
│   │   ├── store.ts   # Reduxストア
│   │   └── router.tsx # ルーティング設定
│   ├── components/    # コンポーネント（Atomic Design）
│   │   ├── atoms/     # 基本要素（ボタン、入力など）
│   │   ├── molecules/ # 複合要素（フォームグループなど）
│   │   ├── organisms/ # 機能単位（タスクリストなど）
│   │   ├── templates/ # ページレイアウト
│   │   └── ui/        # 共通UI要素
│   ├── features/      # 機能モジュール
│   │   ├── auth/      # 認証関連
│   │   ├── tasks/     # タスク管理
│   │   ├── calendar/  # カレンダー
│   │   ├── menu/      # 献立管理
│   │   └── places/    # お出かけスポット
│   ├── hooks/         # 共通カスタムフック
│   ├── layouts/       # レイアウトコンポーネント
│   ├── lib/           # ユーティリティ関数
│   ├── styles/        # グローバルスタイル
│   ├── types/         # 型定義
│   ├── App.tsx        # アプリルート
│   ├── main.tsx       # エントリーポイント
│   └── vite-env.d.ts  # Vite環境変数型定義
├── .eslintrc.js       # ESLint設定
├── .prettierrc        # Prettier設定
├── index.html         # HTMLテンプレート
├── package.json       # 依存関係
├── tailwind.config.js # Tailwind設定
├── tsconfig.json      # TypeScript設定
└── vite.config.ts     # Vite設定
```

- **構成意図と運用ルール:**
  - Atomic Design パターンで再利用可能なコンポーネントを構築
  - 機能（features）ごとにモジュール化し、関連するコンポーネント、ロジック、スタイルを集約
  - API ロジックと UI を分離し、テスト容易性と保守性を向上

### 4.5. Lint / Formatter

- **推奨ツール:** ESLint, Prettier
- **推奨設定/プラグイン:**
  - `eslint-config-airbnb-typescript` - React/TypeScript の基本ルール
  - `eslint-plugin-react-hooks` - React フックのルール
  - `eslint-plugin-import` - import の順序など
  - `eslint-plugin-jsx-a11y` - アクセシビリティ
  - `eslint-plugin-tailwindcss` - Tailwind CSS の最適化
- **導入によるメリットと運用ルール:**
  - コード品質と一貫性の確保
  - コミット前の自動チェック（husky + lint-staged）
  - CI パイプラインでの検証

### 4.6. 基本的なテスト方針

- **MVP における現実的なテスト戦略:**
  - 重要な機能のユニットテスト（認証、タスク管理など）
  - 主要なユーザーフローのインテグレーションテスト
  - 最初は 100%カバレッジにこだわらず、重要な部分から徐々にカバレッジを高める
- **推奨ライブラリ:**
  - Jest - テストランナー
  - React Testing Library - コンポーネントテスト
  - MSW (Mock Service Worker) - API モック
- **テストの書き方や運用ガイドライン:**
  - テストファイルは対象コードと同じディレクトリに配置（`*.test.tsx`）
  - ユーザーの操作に焦点を当てたテスト（実装詳細ではなく動作をテスト）
  - スナップショットテストは必要最小限に

## 5. UI/UX デザイン基本方針

### 5.1. 全体的なデザインコンセプト

- **目指すスタイル:**
  - クリーン、モダン、使いやすさを重視
  - MUI をベースとしつつ、Tailwind CSS でカスタマイズ
  - 情報の整理と優先順位付けを明確に
  - モバイルファーストの考え方（優先度は低いがデザイン時に考慮）
- **配色:**
  - プライマリカラー: #3f51b5（インディゴ）
  - セカンダリカラー: #f50057（ピンク）
  - アクセントカラー: #00bcd4（シアン）
  - ニュートラル: グレースケール（#f5f5f5〜#212121）
- **タイポグラフィ:**
  - 基本フォント: Roboto
  - 見出し: Roboto（ウェイト: 500, 700）
  - 本文: Roboto（ウェイト: 400）

### 5.2. Atomic Design の適用方針

- 最初から厳密な分割に固執せず、機能単位で構築
- 共通パターンが見えてきたらコンポーネントを抽出・共通化
- 初期段階では以下に注力:
  - atoms: Button, TextField, Badge, Icon, Typography
  - molecules: SearchBar, FormGroup, TaskItem, CalendarDay
  - organisms: TaskList, Calendar, FamilyMemberList
  - templates: DashboardTemplate, TaskPageTemplate

### 5.3. 主要画面のレイアウト構成案

#### **ダッシュボード画面:**

- `Box` - メインコンテナ
  - `AppBar` - トップナビゲーション（ロゴ、ユーザーメニュー）
  - `Drawer` - サイドナビゲーション（各機能へのリンク）
  - `Container` - メインコンテンツエリア
    - `Grid` - ウィジェットグリッド
      - `Card` - 今日のタスクウィジェット
      - `Card` - 今日の献立ウィジェット
      - `Card` - 今日の予定ウィジェット
      - `Card` - お出かけスポットウィジェット

#### **タスク一覧画面:**

- `Box` - メインコンテナ
  - `AppBar` - トップナビゲーション
  - `Drawer` - サイドナビゲーション
  - `Container` - メインコンテンツエリア
    - `Box` - ヘッダーエリア
      - `Typography` - ページタイトル「タスク一覧」
      - `Button` - 新規タスク作成ボタン
    - `Box` - フィルターエリア
      - `Select` - ステータスフィルター
      - `Select` - 優先度フィルター
      - `Select` - 担当者フィルター
      - `TextField` - 検索フィールド
    - `Paper` - タスクリストエリア
      - `List` or `TableContainer` - タスクリスト
        - タスクアイテム（繰り返し）
          - チェックボックス、タイトル、期限、担当者、タグ、アクション

#### **タスク作成/編集モーダル:**

- `Dialog` - モーダルコンテナ
  - `DialogTitle` - 「タスクを作成」または「タスクを編集」
  - `DialogContent` - フォームエリア
    - `TextField` - タスクタイトル
    - `TextField` - タスク詳細（multiline）
    - `DatePicker` - 期限日
    - `Select` - ステータス選択
    - `Select` - 優先度選択
    - `Autocomplete` - 担当者選択
    - `Autocomplete` - タグ選択（複数選択可）
    - `FormControlLabel` + `Switch` - ルーティンタスクフラグ
  - `DialogActions` - アクションエリア
    - `Button` - キャンセルボタン
    - `Button` - 保存ボタン

## 6. バックエンド連携とスキーマ活用方針

- **バックエンド API:** FastAPI で構築済み（OpenAPI 仕様書を活用）
- **データ連携:**
  - axios を使用して API 通信を行い、カスタムフックで状態管理
  - ローディング状態、エラー処理は共通ロジックとして実装
  - 必要に応じて Redux Toolkit のスライスでグローバル状態管理
- **Zod スキーマの活用:**
  - バックエンドの OpenAPI スキーマから Zod スキーマを生成
  - フォームバリデーションとして活用
  - API レスポンスの型定義としても活用

## 7. 実装ステップ計画

1. **プロジェクトセットアップ**

   - Vite を使って React プロジェクトを作成
   - 必要なライブラリをインストール
   - ESLint/Prettier の設定

2. **基本構造の実装**

   - ルーティング設定
   - レイアウトコンポーネント
   - テーマ設定

3. **認証機能の実装**

   - ログイン/登録画面
   - 認証状態管理
   - 保護されたルート

4. **コアコンポーネントの実装**

   - 基本的な UI 要素（atoms, molecules）
   - 再利用可能なコンポーネント

5. **タスク管理機能の実装**

   - タスク一覧表示
   - タスク作成/編集フォーム
   - フィルター/ソート機能

6. **追加機能の段階的実装**

   - カレンダー機能
   - 献立管理機能
   - お出かけスポット管理

7. **最適化とリファクタリング**
   - パフォーマンス最適化
   - コンポーネントの共通化
   - テストカバレッジの向上

## 8. 今後の展開

- **優先度高**

  - タスク管理機能の MVP 完成
  - ユーザーテストとフィードバック収集

- **中期計画**

  - モバイルレスポンシブ対応の強化
  - オフライン対応（PWA 化）
  - 通知機能の追加

- **長期ビジョン**
  - AI によるタスクの自動提案
  - スマートホーム連携
  - 外部カレンダーとの同期
