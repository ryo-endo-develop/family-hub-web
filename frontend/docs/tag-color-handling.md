# タグの色処理について

## 概要

SyncFamアプリケーションでは、タスクに関連付けられたタグの色の処理を一貫して行うため、ユーティリティ関数を実装しています。これにより、アプリケーション全体でタグの見た目が統一され、ユーザー体験が向上します。

## 主要な機能

### 1. タグの色の決定

タグの色は次のルールで決定されます：

- **タグが既に色を持っている場合**: タグのcolor属性に設定された色を使用
- **タグに色が設定されていない場合**: タグのIDに基づいて決定論的に色を生成
- **選択状態のタグ**: MUIのデフォルト選択色を使用

### 2. テキスト色の自動調整

背景色の明るさに応じて、読みやすさを確保するためにテキスト色を自動的に調整します：

- **暗い背景色**: 白いテキスト（#fff）を使用
- **明るい背景色**: 通常のテキスト色（inherit）を使用

### 3. 一貫したスタイリング

アプリケーション全体で統一したタグの外観を実現するために、以下のコンポーネントで同じスタイリングユーティリティを使用しています：

- タスク一覧（TaskList.tsx）
- サブタスク付きタスク一覧（TaskListWithSubtasks.tsx）
- タスク作成/編集ダイアログ（TaskFormDialog.tsx）
- サブタスク作成ダイアログ（SubtaskFormDialog.tsx）

## 実装

タグの色処理は `tagUtils.ts` ファイルに実装されています。主要な関数は以下の通りです：

### getTagColor(tagId, tagColor, isSelected)

タグの色を決定する関数です。

- **tagId**: タグのID（色生成のシード値として使用）
- **tagColor**: タグに設定されている色（あれば）
- **isSelected**: タグが選択されているかどうか

### shouldUseWhiteText(color)

指定された背景色に対して白いテキストを使用すべきかを判断する関数です。

- **color**: 評価する背景色

### getTagChipStyles(tag, isSelected)

タグチップコンポーネントのスタイルをまとめて生成する関数です。

- **tag**: スタイリングするタグオブジェクト
- **isSelected**: タグが選択されているかどうか

## 使い方

タグを表示する際は、以下のように `getTagChipStyles` 関数を使用します：

```tsx
import { getTagChipStyles } from '../../../utils/tagUtils';

// タグチップコンポーネント内
<Chip
  key={tag.id}
  label={tag.name}
  size="small"
  sx={getTagChipStyles(tag, isSelected)}
/>
```

このアプローチにより、タグの色処理ロジックを一元化し、コードの重複を避けることができます。また、将来的なスタイリングの変更も単一の場所で行えるため、メンテナンス性が向上します。
